<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Friend Requests & Create Bot â€” Botnev</title>
<meta name="description" content="Manage friend requests and create your own AI bot on Botnev! Customize your bot, select voices, and models.">

<!-- Open Graph & Twitter Cards -->
<meta property="og:title" content="Friend Requests & Create Bot â€” Botnev">
<meta property="og:description" content="Manage friend requests and create your own AI bot on Botnev! Customize your bot, select voices, and models.">
<meta property="og:image" content="https://botnet2.netlify.app/assets/og-image.png">
<meta property="og:url" content="https://botnet2.netlify.app/create-bot.html">
<meta property="og:type" content="website">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Friend Requests & Create Bot â€” Botnev">
<meta name="twitter:description" content="Manage friend requests and create your own AI bot on Botnev! Customize your bot, select voices, and models.">
<meta name="twitter:image" content="https://botnet2.netlify.app/assets/og-image.png">

<!-- JSON-LD -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Botnev",
  "url": "https://botnet2.netlify.app/create-bot.html",
  "logo": {
    "@type": "ImageObject",
    "url": "https://botnet2.netlify.app/assets/logo.png",
    "width": 200,
    "height": 200
  },
  "contactPoint": {
    "@type": "ContactPoint",
    "contactType": "customer service",
    "areaServed": "US",
    "availableLanguage": "English"
  }
}
</script>

<style>
/* Layout */
body { display: flex; margin: 0; font-family: Arial, sans-serif; height: 100vh; }

/* Sidebar */
#sidebar { width: 250px; background-color: #1e1e1e; color: #fff; padding: 20px; box-sizing: border-box; overflow-y: auto; }
#sidebar ul { list-style: none; padding: 0; margin: 0; }
#sidebar li { margin-bottom: 10px; }
#sidebar a { color: #fff; text-decoration: none; display: block; padding: 8px 12px; border-radius: 5px; transition: background 0.2s; }
#sidebar a:hover { background-color: #333; }

/* Main content */
#mainContent { flex-grow: 1; overflow-y: auto; padding: 20px; background: #f9fafc; }

/* Profile header */
.profile-header { display:flex; align-items:center; gap:15px; margin-bottom:20px; }
.profile-header img { width:50px; height:50px; border-radius:50%; object-fit:cover; }
.online { color: lime; font-weight: bold; }
.offline { color: gray; font-weight: bold; }

/* Forms and buttons */
form { max-width: 500px; margin-bottom: 30px; background:#fff; padding:20px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
input, textarea, select, button { width:100%; margin-bottom:15px; padding:10px; font-size:14px; border-radius:5px; border:1px solid #ccc; }
button { background:#007bff; color:white; border:none; cursor:pointer; }
button:hover { background:#0056b3; }

/* Output messages */
.output { margin-top:15px; font-family:monospace; padding:10px; border-radius:6px; }
.output.success { background:#e6ffed; color:#256d1b; border:1px solid #8dd48a; }
.output.error { background:#ffe6e6; color:#a12626; border:1px solid #f5a3a3; }

/* Friend requests */
#incomingRequests div { display:flex; align-items:center; justify-content:space-between; margin-bottom:10px; padding:5px; background:#fff; border-radius:5px; box-shadow:0 1px 3px rgba(0,0,0,0.1); }
#incomingRequests div button { margin-left:5px; padding:3px 8px; }

/* iframe */
#iframeContainer { margin-top:20px; height:500px; border:1px solid #ccc; }

/* Chat bubble */
#chatBubble {
  position: fixed; bottom:20px; right:20px; width:64px; height:64px; border-radius:50%; background:#007bff; color:white;
  display:flex; flex-direction:column; align-items:center; justify-content:center; cursor:pointer; box-shadow:0 4px 12px rgba(0,0,0,0.25); z-index:9999;
}
#chatBubble span { font-size:10px; margin-top:2px; max-width:55px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
#chatBadge { position:absolute; top:6px; right:6px; background:red; color:white; font-size:10px; padding:2px 6px; border-radius:50%; display:none; }

@media (max-width:768px){
  body { flex-direction: column; }
  #sidebar { width:100%; height:auto; }
  #mainContent { padding:10px; }
}
</style>
</head>
<body>

<!-- Sidebar -->
<div id="sidebar">
  <ul>
    <li><a href="/create.html?user=@scoobydo">âš™ï¸ Create a Bot</a></li>
    <li><a href="/marketplace.html?character=scoobydo">ğŸ›’ Marketplace</a></li>
    <li><a href="/explore.html?user=@scoobydo">ğŸ” Explore Bots</a></li>
    <li><a href="/index.html?user=@scoobydo">ğŸ  Home</a></li>
    <li><a href="/login.html?redirect=user=@scoobydo">ğŸ”— Login</a></li>
    <li><a href="signup.html">Signup</a></li>
    <li><a href="page/index.html?ref=@scoobydoo">ğŸ¤£ boteos</a></li>
    <li><a href="dialogue.html?ref=@fortniteCod6">ğŸ™‡ğŸ§â€â™€ï¸ğŸ§â€â™‚ï¸ğŸ§ dialogue</a></li>
    <li><a href="email.html?ref=@dude">ğŸš“ğŸš•ğŸ›º email</a></li>
    <li><a href="fullSettings.html?ref=@nathenisdiddy">ğŸ‡ğŸ§¨âœ¨ğŸ‰ nateyourdiddy</a></li>
    <li><a href="site-builder.html?ref=@IsaiahIsStraight">ğŸ‡ğŸ§¨âœ¨ğŸ‰ site-builder</a></li>
    <li><a href="recovery-login.html?ref=@recovery-login">ğŸ”— recovery-login</a></li>
    <li><a href="video.html?ref=@video-page">ğŸ‡ğŸ§¨âœ¨ğŸ‰ video-page</a></li>
    <li><a href="media.html?ref=@media-page">ğŸ§ğŸ’½ğŸ“€ğŸ”Š media-page</a></li>
  </ul>
</div>

<!-- Main content -->
<div id="mainContent">
  <div class="profile-header" id="profile"></div>
  <h1>ğŸ¤– Create Your Bot</h1>

  <form id="botForm">
    <input type="text" id="botName" placeholder="Bot Name" required />
    <textarea id="description" placeholder="Describe your bot..." required></textarea>

    <label for="voiceSelect">Select Voice:</label>
    <select id="voiceSelect" required><option value="">Loading voices...</option></select>

    <label for="fbxSelect">Select FBX Model:</label>
    <select id="fbxSelect" required><option value="">Choose FBX Model</option></select>

    <input type="text" id="gumroadLink" placeholder="Optional Gumroad Link for paid model" />
    <button type="submit">Create Bot</button>
  </form>

  <div id="output" class="output"></div>

  <h2>Incoming Friend Requests</h2>
  <div id="incomingRequests"></div>

  <input type="email" id="friendEmail" placeholder="Friend's Email">
  <button id="sendRequestBtn">Send Friend Request</button>

  <div id="iframeContainer">
    <iframe id="content-frame" src="" frameborder="0" style="width:100%; height:100%;"></iframe>
  </div>
</div>

<!-- Chat bubble -->
<div id="chatBubble" onclick="openChat()">
  ğŸ’¬
  <span id="chatUsername">Chat</span>
  <div id="chatBadge">!</div>
</div>

<!-- Fullscreen iframe overlay -->
<!-- Fullscreen iframe overlay -->
<div id="iframeOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:10000;">
  <button id="closeIframe" style="
      position:absolute; 
      top:10px; 
      right:10px; 
      width:30px; 
      height:30px; 
      font-size:20px; 
      line-height:30px; 
      padding:0; 
      border:none; 
      background:rgba(255,255,255,0.2); 
      color:white; 
      cursor:pointer; 
      border-radius:50%;
      text-align:center;
  ">Ã—</button>
  <iframe id="overlayFrame" src="" style="width:100%; height:100%; border:none;"></iframe>
</div>


<script>
// -----------------------
// SIDEBAR OVERLAY
// -----------------------
const links = document.querySelectorAll('#sidebar a');
const overlay = document.getElementById('iframeOverlay');
const overlayFrame = document.getElementById('overlayFrame');
const closeBtn = document.getElementById('closeIframe');

links.forEach(link => {
  link.addEventListener('click', e => {
    e.preventDefault();
    overlayFrame.src = link.href;
    overlay.style.display = 'block';
  });
});

closeBtn.addEventListener('click', () => {
  overlayFrame.src = '';
  overlay.style.display = 'none';
});

// -----------------------
// CHAT NAVIGATION
// -----------------------
function openChat() { window.location.href = '/chat.html'; }

// -----------------------
// LOAD USER PROFILE
// -----------------------
async function loadProfile() {
  try {
    const res = await fetch('/.netlify/functions/settings', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      credentials: 'include'
    });
    const result = await res.json();
    if (!result.success) throw new Error(result.error || 'Failed to fetch user');

    const user = result.user || {};
    window.userEmail = user.email;
    const online = !!user.online;
    const avatarUrl = user.avatar_url || `https://avatars.dicebear.com/api/initials/${encodeURIComponent(user.email || 'user')}.svg`;

    document.getElementById('profile').innerHTML = `
      <img id="avatarPreview" src="${avatarUrl}" alt="Profile" />
      <span>${user.username || user.email || 'User'} - 
        <span id="statusIndicator" class="${online ? 'online' : 'offline'}">${online ? 'Online' : 'Offline'}</span>
      </span>
      <div style="margin-top:10px;">
        <label>Change Avatar URL: <input type="text" id="avatarInput" placeholder="New avatar URL" /></label>
        <button id="updateAvatarBtn">Update Avatar</button>
      </div>
      <div style="margin-top:5px;">
        <label>Online Status: 
          <select id="statusSelect">
            <option value="true" ${online ? 'selected' : ''}>Online</option>
            <option value="false" ${!online ? 'selected' : ''}>Offline</option>
          </select>
        </label>
        <button id="updateStatusBtn">Update Status</button>
      </div>
    `;
    document.getElementById('chatUsername').textContent = user.username || user.email || 'Chat';

    // Update avatar
    document.getElementById('updateAvatarBtn').addEventListener('click', async () => {
      const newAvatar = document.getElementById('avatarInput').value.trim();
      if (!newAvatar) return alert('Please enter a valid URL');
      const res = await fetch('/.netlify/functions/settings', {
        method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include',
        body: JSON.stringify({ avatar_url: newAvatar })
      });
      const data = await res.json();
      if(data.success){ document.getElementById('avatarPreview').src = newAvatar; alert('Avatar updated!'); }
      else alert('Failed: '+data.error);
    });

    // Update status
    document.getElementById('updateStatusBtn').addEventListener('click', async () => {
      const newStatus = document.getElementById('statusSelect').value==='true';
      const res = await fetch('/.netlify/functions/settings', {
        method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include',
        body: JSON.stringify({ online: newStatus })
      });
      const data = await res.json();
      if(data.success){
        const s = document.getElementById('statusIndicator');
        s.textContent = newStatus?'Online':'Offline';
        s.className = newStatus?'online':'offline';
        alert('Status updated!');
      } else alert('Failed: '+data.error);
    });

  } catch(e){ console.error(e); }
}

// -----------------------
// FRIEND REQUESTS
// -----------------------
async function loadIncoming() {
  try {
    const res = await fetch('/.netlify/functions/friend-requests', {
      method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include',
      body: JSON.stringify({ action:'list', user_email: window.userEmail })
    });
    const data = await res.json();
    const container = document.getElementById('incomingRequests');
    container.innerHTML = '';
    data.forEach(req => {
      const div = document.createElement('div');
      div.innerHTML = `<span>${req.sender_email}</span>
        <button onclick="respond('${req.id}','accepted')">Accept</button>
        <button onclick="respond('${req.id}','rejected')">Reject</button>`;
      container.appendChild(div);
    });
  } catch(e){ console.error(e); }
}

window.respond = async (id,status) => {
  const res = await fetch('/.netlify/functions/friend-requests',{
    method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include',
    body: JSON.stringify({ action:'respond', request_id:id, status })
  });
  const data = await res.json();
  alert(data.success?`Request ${status}`:data.error);
  loadIncoming();
};

document.getElementById('sendRequestBtn').addEventListener('click', async ()=>{
  const receiver_email = document.getElementById('friendEmail').value;
  const res = await fetch('/.netlify/functions/friend-requests',{
    method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include',
    body: JSON.stringify({ action:'send', sender_email: window.userEmail, receiver_email })
  });
  const data = await res.json();
  alert(data.success?'Request sent!':data.error);
  loadIncoming();
});

// -----------------------
// BOT CREATION
// -----------------------
const form = document.getElementById('botForm');
const output = document.getElementById('output');
const voiceSelect = document.getElementById('voiceSelect');
const fbxSelect = document.getElementById('fbxSelect');

async function loadVoices() {
  try {
    const res = await fetch('/.netlify/functions/get-voices',{ method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include' });
    const voices = await res.json();
    voiceSelect.innerHTML = '<option value="">Select Voice</option>';
    voices.forEach(v=>{ const opt=document.createElement('option'); opt.value=v.id; opt.textContent=`${v.name} (${v.lang})`; voiceSelect.appendChild(opt); });
  } catch(e){ voiceSelect.innerHTML='<option value="">Failed to load voices</option>'; console.error(e);}
}

const fbxModels = [{id:'model1',name:'Humanoid Default'},{id:'model2',name:'Robot Model'}];
fbxModels.forEach(m=>{ const opt=document.createElement('option'); opt.value=m.id; opt.textContent=m.name; fbxSelect.appendChild(opt); });

form.addEventListener('submit', async e=>{
  e.preventDefault();
  const name=document.getElementById('botName').value.trim();
  const description=document.getElementById('description').value.trim();
  const voice_id=voiceSelect.value;
  const fbx_model_id=fbxSelect.value;
  const paid_link=document.getElementById('gumroadLink').value.trim();

  if(!name||!description||!voice_id||!fbx_model_id){ output.textContent='Please fill all required fields.'; output.className='output error'; return; }
  output.textContent='Creating bot...'; output.className='output';

  try{
    const res = await fetch('/.netlify/functions/overpoweredbot',{
      method:'POST', headers:{'Content-Type':'application/json'}, credentials:'include',
      body: JSON.stringify({ name, description, voice_id, fbx_model_id, paid_link })
    });
    const data = await res.json();
    if(!res.ok||data.error){ output.textContent=`Error: ${data.error||'Unknown'}`; output.className='output error'; return; }
    output.innerHTML=`<strong>Bot Created Successfully!</strong><br>ID/Hash: ${data.id||'N/A'}<br>API Key: ${data.apiKey||'Check Backend'}<br>File: bot.js<br><br>
      <a href="/explore.html">ğŸ” Explore</a> | <a href="/index.html">ğŸ  Home</a>`;
    output.className='output success';
    form.reset();
  }catch(e){ output.textContent='Failed to create bot.'; output.className='output error'; }
});

// -----------------------
// INITIAL LOAD
// -----------------------
loadProfile().then(loadIncoming).then(loadVoices);
</script>
</body>
</html>




